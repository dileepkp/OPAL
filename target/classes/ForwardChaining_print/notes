This version is stable. Next version is to test chunking of input and remove (-2 -2 -2) rules
Also removing unused clauses
