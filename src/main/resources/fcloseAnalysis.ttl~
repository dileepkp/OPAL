@prefix c: <http://www.semanticweb.org/yzhao30/ontologies/2015/7/c#> .
@prefix file0: </home/demo/Downloads/PATO-ROSE-master/tools/onto-build-rose/test/writeToFile.c#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix pa: <http://www.semanticweb.org/aidb/ontologies/BugFindingOntology#> .

//   -
//   double fclose
//   - an opened file is eventually closed

pa:queryList pa:contains pa:0_0 .
pa:0_0 rdf:type pa:query .
pa:0_0 pa:atProgramPoint pa:0_1 .
pa:0_1 pa:programPointSettings pa:preCall .
pa:0_1 pa:programPointType pa:sparql .
pa:0_1 pa:value '''SELECT ?exp 
        WHERE {
                ?exp rdf:type c:ExpressionStatement.
		?exp c:hasExpression ?func.		
		?func rdf:type c:FunctionCall.
		?func c:call ?call.
		?call rdf:type c:FunctionRef.
		?call c:hasName 'fclose'
	}''' .
pa:0_0 pa:hasQueryCondition pa:0_2 .
pa:0_2 pa:hasLHS pa:0_3 .
pa:0_3 pa:queryConditionType pa:variable .
pa:0_3 pa:queryConditionSource pa:sparql .
pa:0_3 pa:value ''' SELECT ?var  
        WHERE {
              ?func rdf:type c:FunctionCall.
		?func c:call ?call.
		?call rdf:type c:FunctionRef.
		?call c:hasName 'fclose'.
		?func c:hasArgumentExpr ?y.
		?y c:NthArg '0'.
		?y c:referTo ?var.
            }''' .
pa:0_2 pa:hasRHS pa:0_4 .
pa:0_4 pa:queryConditionType pa:value .
pa:0_4 pa:dataType xsd:int .
pa:0_4 pa:value "0" .
pa:0_2 pa:hasRelation pa:0_5 .
pa:0_5 pa:value pa:notEqual .

pa:queryList pa:contains pa:1_0 .
pa:1_0 rdf:type pa:query .
pa:1_0 pa:atProgramPoint pa:1_1 .
pa:1_1 pa:programPointSettings pa:preCall .
pa:1_1 pa:programPointType pa:sparql .
pa:1_1 pa:value '''SELECT ?last 
        WHERE {
                ?func pa:endExecutionInFunction ?last
	}''' .
pa:1_0 pa:hasQueryCondition pa:1_2 .
pa:1_2 pa:hasLHS pa:1_3 .
pa:1_3 pa:queryConditionType pa:variable .
pa:1_3 pa:queryConditionSource pa:sparql .
pa:1_3 pa:value ''' SELECT ?var  
        WHERE {
		?var rdf:type c:Variable .
		?var c:hasBaseType c:_IO_FILE .
            }''' .
pa:1_2 pa:hasRHS pa:1_4 .
pa:1_4 pa:queryConditionType pa:value .
pa:1_4 pa:dataType xsd:int .
pa:1_4 pa:value "0" .
pa:1_2 pa:hasRelation pa:1_5 .
pa:1_5 pa:value pa:equals .
