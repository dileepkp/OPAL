@prefix c: <http://www.semanticweb.org/yzhao30/ontologies/2015/7/c#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix pa: <http://www.semanticweb.org/aidb/ontologies/BugFindingOntology#> .

#Double fopen

pa:queryList pa:contains pa:1_0 .
pa:1_0 rdf:type pa:query .
pa:1_0 pa:programPointSettings pa:postCall .
pa:1_0 pa:queryModel pa:VarRelVal .
pa:1_0 pa:hasQueryCondition pa:1_2 .
pa:1_2 pa:hasLHS pa:1_3 .
pa:1_3 pa:queryConditionType pa:variable .
pa:1_3 pa:queryConditionSource pa:sparql .
pa:1_3 pa:value ''' SELECT DISTINCT ?exp ?var (c:VariableRef as ?varType)
        WHERE {
		{
		?var rdf:type c:Variable .
		?var c:hasInitializer/c:hasInitialValue ?func.
		bind(?var as ?exp)
		}
		UNION
		{
		?exp rdf:type c:ExpressionStatement .
		?exp c:hasExpression ?exp2_1 .
		?exp2_1 rdf:type c:AssignOp .
		?exp2_1 c:hasLeftOperand ?left .
		?exp2_1 c:hasRightOperand ?func.
		?left rdf:type c:VariableRef .
		?left c:referTo ?var.
		}

             ?func rdf:type c:FunctionCall.
		?func c:call ?call.
		?call rdf:type c:FunctionRef.
		?call c:hasName 'fopen'.

		?var pa:hasState ?ps . 
		?ps pa:atProgramPoint ?pp.
		?pp pa:afterStatement ?expb4.
		?expb4 pa:nextStatement ?exp.
		FILTER EXISTS {	?ps pa:stateValue ?val.
				?ps pa:pointsToResource ?res. 
				}

            }''' .

pa:1_2 pa:hasRHS pa:1_4 .
pa:1_4 pa:queryConditionType pa:value .
pa:1_4 pa:dataType xsd:int .
pa:1_4 pa:value 0 .
pa:1_2 pa:hasRelation pa:1_5 .
pa:1_5 pa:value pa:greaterThan .
